{% extends 'faculty/base.html' %}
{% load static %}
{% load dict_extras %}


{% block content %}

<h2>Semester {{ semester }} - Attendance â€“ {{ subject.subject_name }}</h2>
<p>
  <b>Date:</b> {{ date }} |
  <b>Period:</b> {{ period }}
  
</p>
<form method="post">
  {% csrf_token %}
  {% if messages %}
      {% for message in messages %}
        <div class="alert alert-success">
          {{ message }}
        </div>
      {% endfor %}
  {% endif %}

  <table class="table">
    <thead>
      <tr>
        <th>Roll No</th>
        <th>Name</th>
        <th>Present</th>
      </tr>
    </thead>

    <tbody>
      {% for student in students %}
      <tr>
        <td>{{ student.roll_no }}</td>
        <td>{{ student.name }}</td>
        <td>
          <input type="checkbox"
       name="present_{{ student.id }}"
       {% if attendance_map|get_item:student.id %}checked{% endif %}>

        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div style="margin-top:10px;">
    <button type="button" onclick="markAll(true)">Mark All</button>
    <button type="button" onclick="markAll(false)">Unmark All</button>
  </div>

  <br>

  <label>Subject Covered</label><br>
  <input type="text" name="subject_covered" style="width:60%"><br><br>

  <label>Remarks</label><br>
  <textarea name="remarks" style="width:60%"></textarea>

  <br><br>
  <button type="submit">Save Attendance</button>
</form>
<script>
function markAll(value) {
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.checked = value;
    });
}
setTimeout(() => {
    document.querySelectorAll('.alert').forEach(el => el.style.display = 'none');
  }, 3000);
</script>



{% endblock %}
